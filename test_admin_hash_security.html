<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Admin Hash Security</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-case {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background: #f9f9f9;
        }
        .success { border-color: #28a745; background: #d4edda; }
        .error { border-color: #dc3545; background: #f8d7da; }
        .warning { border-color: #ffc107; background: #fff3cd; }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        pre {
            background: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>🔒 Test de Seguridad Admin - Solo Hash</h1>
    
    <div class="test-case warning">
        <h3>📋 Propósito del Test</h3>
        <p>Verificar que la página de administración solo permite acceso mediante hash válido y rechace nombres de usuario.</p>
    </div>

    <div class="test-case">
        <h3>🧪 Test Cases</h3>
        <div id="testResults"></div>
        
        <h4>URLs a Probar:</h4>
        <button class="test-button" onclick="testValidHash()">✅ Test Hash Válido</button>
        <button class="test-button" onclick="testInvalidUsername()">❌ Test Username (debe fallar)</button>
        <button class="test-button" onclick="testInvalidHash()">❌ Test Hash Inválido</button>
        <button class="test-button" onclick="testEmptyParam()">❌ Test Parámetro Vacío</button>
    </div>

    <div class="test-case">
        <h3>📝 Resultados Esperados:</h3>
        <ul>
            <li><strong>Hash válido:</strong> Debe cargar la página de admin normalmente</li>
            <li><strong>Username:</strong> Debe mostrar error "Acceso administrativo no autorizado"</li>
            <li><strong>Hash inválido:</strong> Debe mostrar error de formato</li>
            <li><strong>Parámetro vacío:</strong> Debe manejar el error graciosamente</li>
        </ul>
    </div>

    <div class="test-case success">
        <h3>🔧 Hash de Ejemplo para Pruebas</h3>
        <p>Hash del usuario "testuser": <code id="testHash">a1b2c3d4e5f6789a</code></p>
        <button class="test-button" onclick="copyHash()">📋 Copiar Hash</button>
        <button class="test-button" onclick="generateNewHash()">🔄 Generar Nuevo Hash</button>
    </div>

    <script>
        function addTestResult(title, url, expected, status) {
            const container = document.getElementById('testResults');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-case ${status}`;
            resultDiv.innerHTML = `
                <h4>${title}</h4>
                <p><strong>URL:</strong> <code>${url}</code></p>
                <p><strong>Esperado:</strong> ${expected}</p>
                <p><strong>Estado:</strong> ${status === 'success' ? '✅ Listo para probar' : status === 'error' ? '❌ Error' : '⚠️ Advertencia'}</p>
                <button class="test-button" onclick="window.open('${url}', '_blank')">🌐 Abrir en Nueva Pestaña</button>
            `;
            container.appendChild(resultDiv);
        }

        function testValidHash() {
            const hash = document.getElementById('testHash').textContent;
            const url = `/admin/seguimiento/${hash}`;
            addTestResult(
                'Test Hash Válido', 
                url, 
                'Debe cargar la página de admin normalmente', 
                'success'
            );
        }

        function testInvalidUsername() {
            const url = '/admin/seguimiento/testuser';
            addTestResult(
                'Test Username (debe fallar)', 
                url, 
                'Debe mostrar error "Acceso administrativo no autorizado"', 
                'error'
            );
        }

        function testInvalidHash() {
            const url = '/admin/seguimiento/invalidhash123';
            addTestResult(
                'Test Hash Inválido', 
                url, 
                'Debe mostrar error de formato de hash', 
                'error'
            );
        }

        function testEmptyParam() {
            const url = '/admin/seguimiento/';
            addTestResult(
                'Test Parámetro Vacío', 
                url, 
                'Debe manejar el error graciosamente', 
                'warning'
            );
        }

        function copyHash() {
            const hash = document.getElementById('testHash').textContent;
            navigator.clipboard.writeText(hash).then(() => {
                alert('Hash copiado al portapapeles: ' + hash);
            });
        }

        function generateNewHash() {
            // Simular un hash de 16 caracteres hexadecimales
            const chars = '0123456789abcdef';
            let hash = '';
            for (let i = 0; i < 16; i++) {
                hash += chars[Math.floor(Math.random() * chars.length)];
            }
            document.getElementById('testHash').textContent = hash;
            alert('Nuevo hash generado: ' + hash);
        }

        // Limpiar resultados anteriores al cargar
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('testResults').innerHTML = '<p><em>Haz clic en los botones de arriba para ejecutar los tests...</em></p>';
        });
    </script>
</body>
</html>
